# Блог на PHP (процедурный стиль)

## Требования
- PHP 7.4+
- SQLite3
- Apache/Nginx с поддержкой .htaccess или конфигурацией

## Установка

1. Распакуйте архив в директорию веб-сервера
2. Убедитесь, что директории `db/` и `uploads/` имеют права на запись (chmod 755)
3. Настройте параметры в `config.php`:
   - `SITE_NAME` - название вашего сайта
   - `SITE_DESCRIPTION` - описание сайта
   - `SITE_AUTHOR` - автор сайта
   - `MAX_FILE_SIZE` - максимальный размер загружаемых файлов
   - `POSTS_PER_PAGE` - количество постов на странице
4. Откройте сайт в браузере
5. База данных создастся автоматически при первом запуске

## Настройка

### config.php

Основные настройки находятся в файле `config.php`:
```php
// Название и описание сайта
define('SITE_NAME', 'Мой Блог');
define('SITE_DESCRIPTION', 'Персональный блог');
define('SITE_AUTHOR', 'Администратор');

// Ограничения загрузки
define('MAX_FILE_SIZE', 50 * 1024 * 1024); // 50MB

// Настройки отображения
define('POSTS_PER_PAGE', 10);
```

## Дефолтный пользователь

- Логин: `admin`
- Пароль: `admin123`

**Важно для продакшена:**
```bash
# Создать нового администратора
php create_admin.php

# Удалить дефолтного admin
php disable_default_admin.php
```

## Структура

- `/` - Главная страница (список записей)
- `/post.php?slug=XXX` - Просмотр записи
- `/login.php` - Вход
- `/register.php` - Регистрация
- `/admin/` - Админ-панель

## Возможности

- Создание/редактирование/удаление записей
- Категории и хештеги
- Комментарии
- Загрузка файлов (изображения, видео, документы, архивы)
- Markdown разметка с подсветкой синтаксиса
- Кнопка копирования кода
- Сортировка постов по дате и названию
- Поиск по содержимому
- Фильтрация по категориям и хештегам
- Три уровня прав: Гость, Доверенный, Автор

## CLI команды
```bash
# Создать администратора
php create_admin.php

# Список пользователей
php list_users.php

# Изменить пароль
php change_password.php

# Удалить дефолтного admin
php disable_default_admin.php
```

## Безопасность

- Пароли хешируются через password_hash()
- Защита от SQL-инъекций (prepared statements)
- XSS защита (htmlspecialchars)
- Валидация типов файлов при загрузке
- Транслитерация имен файлов

## Запуск встроенного сервера PHP
```bash
# Базовый запуск
php -S localhost:8080

# С увеличенными лимитами
php -S localhost:8080 -d upload_max_filesize=50M -d post_max_size=50M -d memory_limit=256M

# Или использовать готовый скрипт
./server.sh  # Linux/Mac
server.bat   # Windows
```

## Лицензия

MIT License