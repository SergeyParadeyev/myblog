# CLI команды управления

## Управление пользователями

### Создание администратора
```bash
php create_admin.php
```

Интерактивно создает нового администратора или обновляет существующего пользователя.

---

### Список пользователей
```bash
php list_users.php
```

Выводит список всех пользователей с их ролями.

---

### Изменение пароля
```bash
php change_password.php
```

Изменяет пароль любого пользователя.

---

### Удаление пользователя
```bash
php delete_user.php
```

Удаляет пользователя со всеми его постами, комментариями и файлами.

**Внимание:** 
- Нельзя удалить единственного администратора
- Удаление администратора требует двойного подтверждения
- Все данные пользователя будут безвозвратно удалены

**Пример:**
```
=== Удаление пользователя ===

Введите логин пользователя для удаления: john

Информация о пользователе:
ID: 5
Логин: john
Роль: Доверенный

Будет удалено:
- Постов: 12
- Комментариев: 45
- Файлов: 8

ВНИМАНИЕ! Это действие необратимо!
Вы уверены? Введите 'YES': YES

✓ Пользователь 'john' успешно удален!
```

---

### Массовое удаление пользователей
```bash
php batch_delete_users.php
```

Удаляет несколько пользователей одновременно.

**Варианты использования:**

1. По списку ID:
```
   ID или фильтр: 2,3,5
```

2. По роли:
```
   ID или фильтр: role:trusted
   ID или фильтр: role:guest
```

**Ограничения:**
- Нельзя массово удалять администраторов
- Требуется подтверждение 'YES'

---

### Отключение дефолтного admin
```bash
php disable_default_admin.php
```

Удаляет пользователя 'admin' (только если есть другие администраторы).

---

## Рекомендации

### Для продакшена

1. Создать нового администратора:
```bash
   php create_admin.php
```

2. Проверить список:
```bash
   php list_users.php
```

3. Удалить дефолтного admin:
```bash
   php disable_default_admin.php
```

### Очистка тестовых пользователей
```bash
# Удалить всех гостей
php batch_delete_users.php
# Ввести: role:guest

# Удалить конкретных пользователей
php batch_delete_users.php
# Ввести: 2,3,5,7
```

### Безопасность

- Всегда делайте резервную копию БД перед массовым удалением
- Используйте `list_users.php` для проверки перед удалением
- Храните CLI скрипты вне публичной директории на продакшене